<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <title>Статистика на състояния</title>
</h:head>

<h:body>
<h:form id="statsForm">
<f:event type="preRenderView" listener="#{adminStatsBean.load}" />

    <p:growl id="msgs" showDetail="true" life="4000"/>

    <p:panel header="Статистика: резервации по статус"
             rendered="#{loginBean.admin}"
             style="max-width:1000px;margin:20px auto;">

        <p:commandButton value="Обнови"
                         icon="pi pi-refresh"
                         actionListener="#{adminStatsBean.refresh}"
                         update="chart"
                         process="@this"
                         style="margin-bottom:10px"/>
       
        <h:outputText value="Общ брой заявки: #{adminStatsBean.total}"
              style="font-weight:bold;font-size:16px;" />

        <p:barChart id="chart"
                    model="#{adminStatsBean.statusChart}"
                    style="width:100%;height:420px"/>

        <p:separator/>

        <p:commandButton value="Назад"
                         icon="pi pi-arrow-left"
                         action="/halls.xhtml?faces-redirect=true"
                         ajax="false"/>
    </p:panel>

</h:form>
</h:body>
</html>
